```python
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.patches import Circle
from scipy import signal
import os

# --- 1. Mac 环境字体配置 (陈教授专用配置) ---
plt.rcParams['font.sans-serif'] = ['Arial Unicode MS', 'Heiti TC', 'sans-serif']
plt.rcParams['axes.unicode_minus'] = False

# --- 2. 信号处理逻辑 ---

# 定义系统函数的系数
# H(z) = (1 + z^-1) / (1 + 0.8z^-1 - 0.2z^-2)
b = [1, 1]          # 分子系数 (对应 x)
a = [1, 0.8, -0.2]  # 分母系数 (对应 y)

# (1) 计算单位脉冲响应
# 生成一个单位脉冲信号作为输入
n = np.arange(0, 20)
delta = np.zeros_like(n, dtype=float)
delta[0] = 1.0

# 使用 lfilter 求解差分方程得到响应
h_n = signal.lfilter(b, a, delta)

# (2) 计算零极点
zeros, poles, gain = signal.tf2zpk(b, a)

# --- 绘图 ---
fig = plt.figure(figsize=(12, 5))

# 子图1：单位脉冲响应
ax1 = fig.add_subplot(1, 2, 1)
ax1.stem(n, h_n, basefmt=" ")
ax1.set_title('系统的单位脉冲响应 h(n)', fontsize=12)
ax1.set_xlabel('n')
ax1.set_ylabel('幅度')
ax1.grid(True, alpha=0.3)

# 子图2：零极点分布图
ax2 = fig.add_subplot(1, 2, 2)
# 绘制单位圆
unit_circle = Circle((0, 0), 1, color='gray', fill=False, linestyle='--', label='单位圆')
ax2.add_patch(unit_circle)

# 绘制零点 (圈) 和 极点 (叉)
ax2.plot(np.real(zeros), np.imag(zeros), 'o', markersize=9, markerfacecolor='none', markeredgecolor='blue', label='零点')
ax2.plot(np.real(poles), np.imag(poles), 'x', markersize=9, color='red', label='极点')

# 设置坐标轴
ax2.axhline(0, color='black', linewidth=0.5)
ax2.axvline(0, color='black', linewidth=0.5)
ax2.set_xlim([-1.5, 1.5])
ax2.set_ylim([-1.5, 1.5])
ax2.set_aspect('equal')
ax2.set_title('系统零极点分布图', fontsize=12)
ax2.set_xlabel('实部')
ax2.set_ylabel('虚部')
ax2.legend(loc='upper right')
ax2.grid(True, alpha=0.3)

# 标注极点数值
for p in poles:
    ax2.text(np.real(p)+0.1, np.imag(p)+0.1, f'p={p:.2f}', fontsize=9, color='red')

plt.tight_layout()

# --- 3. 自动保存与显示 (固定配置) ---
filename = "离散系统响应与零极点分析.png" 
vault_path = "/Users/heyuhang/Documents/Obsidian Vault"
full_path = os.path.join(vault_path, filename)

try:
    if os.path.exists(full_path):
        os.remove(full_path) # 覆盖旧图
    plt.savefig(full_path, dpi=300, bbox_inches='tight')
    plt.close() # 释放内存
    print(f"![[{filename}]]") # 触发 Obsidian 显示
except Exception as e:
    print(f"Error: {e}")
```