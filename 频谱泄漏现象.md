```python
import numpy as np
import matplotlib.pyplot as plt
import os

# --- 1. Mac 环境字体配置 (陈教授专用配置) ---
plt.rcParams['font.sans-serif'] = ['Arial Unicode MS', 'Heiti TC', 'sans-serif']
plt.rcParams['axes.unicode_minus'] = False

# --- 2. 信号处理逻辑 ---

N = 64              # DFT 点数 (采样点数)
fs = 640.0          # 采样频率
T = 1/fs            # 采样间隔
n = np.arange(N)    # 0 到 N-1

# --- 情况 A: 无泄漏 (整周期截断) ---
# 信号频率 f1 = 100Hz。
# 100Hz 在 640Hz 采样率下，64个点包含正好 10 个周期 (100 * 64/640 = 10)
f1 = 100
x1 = np.cos(2 * np.pi * f1 * n * T)
X1 = np.fft.fft(x1)
mag1 = np.abs(X1)

# --- 情况 B: 有严重泄漏 (非整周期截断) ---
# 信号频率 f2 = 110Hz。
# 110Hz 在 640Hz 采样率下，64个点包含 110 * 0.1 = 11.0 个周期？
# 等等，我们要故意制造非整周期。
# DFT的频率分辨率 bin = fs/N = 640/64 = 10Hz。
# f1=100Hz 是 10Hz 的整数倍，所以没泄漏。
# 让我们选 f2 = 105Hz (处于两个频点之间)，这样必然发生泄漏。
f2 = 105 
x2 = np.cos(2 * np.pi * f2 * n * T)
X2 = np.fft.fft(x2)
mag2 = np.abs(X2)

# 频率轴
freqs = np.fft.fftfreq(N, T)
# 只取前半部分显示
half_N = N // 2
freqs_half = freqs[:half_N]
mag1_half = mag1[:half_N]
mag2_half = mag2[:half_N]

# --- 3. 绘图 ---
plt.figure(figsize=(10, 8))

# 子图 1: 无泄漏情况
plt.subplot(2, 1, 1)
plt.stem(freqs_half, mag1_half, basefmt=" ", linefmt='b-', markerfmt='bo')
plt.title(f'情况A：无泄漏 (信号频率 {f1}Hz 是基频分辨率 10Hz 的整数倍)')
plt.ylabel('幅度')
plt.grid(True)
plt.text(f1 + 10, np.max(mag1_half)*0.8, "能量集中在单一谱线上\n像完美的冲激函数", fontsize=10, color='blue')

# 子图 2: 有泄漏情况
plt.subplot(2, 1, 2)
plt.stem(freqs_half, mag2_half, basefmt=" ", linefmt='r-', markerfmt='ro')
plt.title(f'情况B：严重泄漏 (信号频率 {f2}Hz 不是基频分辨率的整数倍)')
plt.xlabel('频率 (Hz)')
plt.ylabel('幅度')
plt.grid(True)
plt.text(f2 + 20, np.max(mag2_half)*0.6, "能量“泄漏”到了\n周围所有的频率点", fontsize=10, color='red')

plt.tight_layout()

# --- 4. 自动保存与显示 (固定配置) ---
filename = "DFT频谱泄漏现象演示.png"
vault_path = "/Users/heyuhang/Documents/Obsidian Vault"
full_path = os.path.join(vault_path, filename)

try:
    if os.path.exists(full_path):
        os.remove(full_path) # 覆盖旧图
    plt.savefig(full_path, dpi=300, bbox_inches='tight')
    plt.close() # 释放内存
    print(f"![[{filename}]]") # 触发 Obsidian 显示
except Exception as e:
    print(f"Error: {e}")
```