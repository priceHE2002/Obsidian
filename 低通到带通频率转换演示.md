```python
import numpy as np
import matplotlib.pyplot as plt
import os
from scipy import signal

# --- 1. Mac 环境字体配置 (陈教授专用配置) ---
plt.rcParams['font.sans-serif'] = ['Arial Unicode MS', 'Heiti TC', 'sans-serif']
plt.rcParams['axes.unicode_minus'] = False

# --- 2. 信号处理逻辑：低通到带通的频率转换 ---

# 设定带通滤波器指标
# 目标：中心频率 100 rad/s，带宽 40 rad/s
# 即通带范围约为 [82, 122] rad/s (近似)
W0 = 100  # 中心频率
BW = 40   # 带宽
N_proto = 3 # 低通原型的阶数

# 1. 设计归一化低通原型 (Normalized Low-Pass Prototype)
# 截止频率 = 1 rad/s
b_lp, a_lp = signal.butter(N_proto, 1, btype='low', analog=True)

# 2. 进行频率转换：低通 -> 带通 (LP to BP)
# 这一步内部执行了 p = (s^2 + W0^2) / (BW * s) 的代换
b_bp, a_bp = signal.lp2bp(b_lp, a_lp, wo=W0, bw=BW)

# --- 3. 计算频率响应并绘图 ---

# 频率范围
w_lp = np.linspace(0, 3, 500) # 低通原型看 0~3 rad/s
w_bp = np.linspace(20, 200, 1000) # 带通看 20~200 rad/s

# 计算频响
_, h_lp = signal.freqs(b_lp, a_lp, worN=w_lp)
_, h_bp = signal.freqs(b_bp, a_bp, worN=w_bp)

# 绘图
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))

# 子图1：低通原型
ax1.plot(w_lp, np.abs(h_lp), 'b-', linewidth=2)
ax1.axvline(x=1, color='r', linestyle='--', label='截止频率 $\Omega=1$')
ax1.set_title(f'{N_proto} 阶归一化低通原型', fontsize=12)
ax1.set_xlabel('频率 $\eta$ (rad/s)', fontsize=10)
ax1.set_ylabel('幅度', fontsize=10)
ax1.grid(True, linestyle='--', alpha=0.6)
ax1.legend()

# 子图2：转换后的带通
ax2.plot(w_bp, np.abs(h_bp), 'g-', linewidth=2)
# 理论截止频率
w_lower = np.sqrt(W0**2 + (BW/2)**2) - BW/2
w_upper = np.sqrt(W0**2 + (BW/2)**2) + BW/2

ax2.axvline(x=W0, color='k', linestyle=':', label=f'中心频率 $\Omega_0={W0}$')
ax2.axvline(x=w_lower, color='r', linestyle='--', alpha=0.5, label='下截止')
ax2.axvline(x=w_upper, color='r', linestyle='--', alpha=0.5, label='上截止')

ax2.set_title(f'转换后的 {2*N_proto} 阶带通滤波器 (BW={BW})', fontsize=12)
ax2.set_xlabel('频率 $\Omega$ (rad/s)', fontsize=10)
ax2.set_ylabel('幅度', fontsize=10)
ax2.grid(True, linestyle='--', alpha=0.6)
ax2.legend()

plt.tight_layout()

# --- 4. 自动保存与显示 (固定配置) ---
filename = "低通到带通频率转换演示.png" 
vault_path = "/Users/heyuhang/Documents/Obsidian Vault"
full_path = os.path.join(vault_path, filename)

try:
    if os.path.exists(full_path):
        os.remove(full_path) # 覆盖旧图
    plt.savefig(full_path, dpi=300, bbox_inches='tight')
    plt.close() # 释放内存
    print(f"![[{filename}]]") # 触发 Obsidian 显示
except Exception as e:
    print(f"Error: {e}")
```