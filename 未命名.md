```python
import matplotlib.pyplot as plt
import matplotlib.patches as mpatches
from matplotlib.font_manager import FontProperties
import platform
import os

# --- 1. 设置中文字体 ---
# 尝试自动查找系统中的中文字体，以确保汉字正常显示
def get_chinese_font():
    system = platform.system()
    if system == 'Windows':
        font_names = ['SimHei', 'Microsoft YaHei', 'SimSun']
    elif system == 'Darwin':  # macOS
        font_names = ['Heiti TC', 'PingFang SC', 'STHeiti']
    else:  # Linux
        font_names = ['WenQuanYi Micro Hei', 'Droid Sans Fallback']
    
    for font_name in font_names:
        try:
            # 尝试加载字体
            FontProperties(family=font_name)
            # print(f"Using font: {font_name}")
            return font_name
        except:
            continue
    
    # 如果上面的都找不到，尝试硬编码路径（作为最后的备选方案）
    # 如果你仍然遇到中文显示问题，请取消下面适合你系统的注释，并修改为正确的路径
    # font_path = 'C:\\Windows\\Fonts\\simhei.ttf' # Windows 示例
    # font_path = '/System/Library/Fonts/PingFang.ttc' # macOS 示例
    # return FontProperties(fname=font_path).get_name()
    
    print("Warning: No suitable Chinese font found. Characters may not display correctly.")
    return 'sans-serif' # 回退到默认

chinese_font = get_chinese_font()
plt.rcParams['font.sans-serif'] = [chinese_font] + plt.rcParams['font.sans-serif']
plt.rcParams['axes.unicode_minus'] = False # 用于正常显示负号

# --- 2. 定义项目数据 (基于简易推进计划) ---
# 数据结构：ID, 任务名称, 开始周, 结束周, 责任方(简写), 输出成果
tasks = [
    {
        'id': 1, 'name': '1.设备到货与环境准备',
        'start': 1, 'end': 1,
        'resp': '责任: 项目经理/网络部/信息中心',
        'output': '输出: 设备签收单、网络环境勘测报告'
    },
    {
        'id': 2, 'name': '2.设备接入与网络调试',
        'start': 2, 'end': 5,
        'resp': '责任: 网络部/业务单位',
        'output': '输出: 设备接入清单、网络连通性测试报告'
    },
    {
        'id': 3, 'name': '3.数据中台搭建与ERP对接',
        'start': 3, 'end': 6,
        'resp': '责任: 专业公司/信息中心',
        'output': '输出: API文档、数据字典、ERP对接报告'
    },
    {
        'id': 4, 'name': '4.系统配置与应用开发',
        'start': 7, 'end': 9,
        'resp': '责任: 行业中心/业务单位',
        'output': '输出: 系统功能说明书、压力测试报告(含时延)'
    },
    {
        'id': 5, 'name': '5.联调测试与用户培训',
        'start': 10, 'end': 11,
        'resp': '责任: 全体项目组/业务单位/信息中心',
        'output': '输出: 系统联调报告、用户手册、培训签到表'
    },
    {
        'id': 6, 'name': '6.项目初验 (UAT)',
        'start': 12, 'end': 12,
        'resp': '责任: 项目经理/信息经理/集团副总',
        'output': '里程碑: 初验通过 (输出: 初验报告, 试运行方案)'
    },
]

# --- 3. 绘图参数设置 ---
# 为了让任务1显示在最上面，我们需要反转列表顺序
tasks_reversed = list(reversed(tasks))
n_tasks = len(tasks)
weeks = 12
colors = ['#5B9BD5', '#70AD47', '#ED7D31', '#A5A5A5', '#4472C4', '#C00000'] # 为每个任务分配不同颜色

fig, ax = plt.subplots(figsize=(14, 8)) # 设置画布大小

# --- 4. 绘制甘特图条形 ---
for i, task in enumerate(tasks_reversed):
    # 计算绘制参数
    # y坐标：直接使用索引 i
    y_pos = i 
    # x起点：第几周开始，就从 (start-1) 的位置开始画
    start_plot = task['start'] - 1
    # 持续时间（宽度）：结束周 - 开始周 + 1
    duration = task['end'] - task['start'] + 1
    
    # 特殊处理：如果是最后一个任务（里程碑），用红色菱形表示，而不是条形
    if task['id'] == 6:
        marker_x = task['end'] - 0.5 # 放在第12周的中间
        ax.plot(marker_x, y_pos, marker='D', markersize=15, color=colors[5], zorder=3)
        # 添加里程碑文字
        ax.text(marker_x + 0.3, y_pos, task['output'], 
                va='center', fontsize=10, fontweight='bold', color=colors[5])
        # 添加责任方（在左侧）
        ax.text(marker_x - 0.3, y_pos, task['resp'], 
                va='center', ha='right', fontsize=9, color='#555555')
        
    else:
        # 绘制普通任务条形
        bar_color = colors[task['id']-1]
        ax.barh(y_pos, duration, left=start_plot, height=0.6, align='center', 
                color=bar_color, alpha=0.8, edgecolor='black', linewidth=0.5)
        
        # 在条形内部或左侧显示责任方
        text_x_resp = start_plot + 0.1
        resp_color = 'white' if duration > 2 else 'black' # 短条形字体用黑色，长的用白色
        ax.text(text_x_resp, y_pos, task['resp'], 
                va='center', ha='left', fontsize=9, color=resp_color, clip_on=True)
        
        # 在条形末尾添加关键节点标记（菱形）
        end_plot = start_plot + duration
        ax.plot(end_plot, y_pos, marker='D', markersize=8, color=bar_color, markeredgecolor='black')
        
        # 在标记右侧显示输出成果
        ax.text(end_plot + 0.2, y_pos, task['output'], 
                va='center', ha='left', fontsize=9, color='#333333')


# --- 5. 设置坐标轴和网格 ---
# Y轴设置
ax.set_yticks(range(n_tasks))
ax.set_yticklabels([t['name'] for t in tasks_reversed], fontsize=11)

# X轴设置
ax.set_xlim(0, weeks + 1) # 多留一点空间给文字
ax.set_xticks(range(weeks + 1))
# 生成 "第X周" 的标签，第0个刻度不显示文字
xtick_labels = [''] + [f'第{w}周' for w in range(1, weeks + 1)]
ax.set_xticklabels(xtick_labels, fontsize=10)
ax.set_xlabel('项目周期 (周数)', fontsize=12, fontweight='bold')

# 添加网格线，方便查看进度
ax.grid(axis='x', linestyle='--', alpha=0.5, which='major')
# 在周与周之间添加实线分隔
for w in range(1, weeks + 2):
    ax.axvline(x=w-1, color='gray', linestyle='-', linewidth=0.5, alpha=0.3)


# --- 6. 添加标题和最终调整 ---
plt.title('“工业互联网+安全生产”数字化转型项目一期部署简易推进计划 (甘特图)', fontsize=16, fontweight='bold', pad=20)

# 调整布局以防文字被遮挡
plt.tight_layout()

# 显示图表
plt.show()
```