```python
import numpy as np
import matplotlib.pyplot as plt
import scipy.signal as signal
import os

# --- 1. Mac 环境字体配置 ---
plt.rcParams['font.sans-serif'] = ['Arial Unicode MS', 'Heiti TC', 'sans-serif']
plt.rcParams['axes.unicode_minus'] = False

# --- 2. 信号处理逻辑：部分分式分解 ---

# 已知参数
omega_c = 0.7185

# 构建传递函数 H(s) = num / den
# 分子：omega_c^2
num = [omega_c**2]
# 分母：s^2 + sqrt(2)*omega_c*s + omega_c^2
den = [1, np.sqrt(2)*omega_c, omega_c**2]

print("【多项式系数验证】")
print(f"分子常数项: {num[0]:.4f} (对应图中的 0.5162)")
print(f"分母一次项: {den[1]:.4f} (对应图中的 1.0161)")
print(f"分母常数项: {den[2]:.4f} (对应图中的 0.5162)")

# 使用 scipy 进行部分分式分解 (Residue computation)
# r: 留数 (Residues, 即 A1, A2)
# p: 极点 (Poles, 即 s1, s2)
# k: 直接项 (对于真分式为 [])
r, p, k = signal.residue(num, den)

print("\n【部分分式分解验证】")
for i in range(len(p)):
    print(f"极点 s_{i+1}: {p[i]:.4f}")
    print(f"留数 A_{i+1}: {r[i]:.4f}")

# --- 3. 绘图：S平面极点分布 ---
filename = "模拟滤波器部分分式分解验证.png"
vault_path = "/Users/heyuhang/Documents/Obsidian Vault/DSP/第四章 IIR"
full_path = os.path.join(vault_path, filename)

try:
    plt.figure(figsize=(6, 6))
    
    # 绘制坐标轴
    plt.axhline(0, color='black', linewidth=0.5)
    plt.axvline(0, color='black', linewidth=0.5)
    
    # 绘制单位圆 (归一化参考，虽然这是 S 平面)
    # 这里的圆实际上对应 omega_c 的半径
    theta = np.linspace(0, 2*np.pi, 100)
    plt.plot(omega_c*np.cos(theta), omega_c*np.sin(theta), 'g--', alpha=0.3, label=f'半径 $\omega_c$={omega_c:.4f}')

    # 绘制极点
    plt.scatter(p.real, p.imag, marker='x', color='red', s=100, label='模拟极点 $s_k$', zorder=5)
    
    # 标注数值
    for i, pole in enumerate(p):
        plt.annotate(f"$s_{i+1}$\n{pole:.2f}", (pole.real, pole.imag), 
                     xytext=(10, 10), textcoords='offset points', color='red')

    plt.title(f'二阶巴特沃斯模拟滤波器 S 平面极点\n$\omega_c = {omega_c}$')
    plt.xlabel('Real ($\sigma$)')
    plt.ylabel('Imaginary ($j\omega$)')
    plt.grid(True, linestyle=':', alpha=0.6)
    plt.legend()
    plt.axis('equal')

    if os.path.exists(full_path):
        os.remove(full_path)
    plt.savefig(full_path, dpi=300, bbox_inches='tight')
    plt.close()
    print(f"![[{filename}]]")

except Exception as e:
    print(f"Error: {e}")
```