```python
import numpy as np
import matplotlib.pyplot as plt
from scipy import signal
import os

# --- 1. Mac 环境字体配置 (陈教授专用配置) ---
plt.rcParams['font.sans-serif'] = ['Arial Unicode MS', 'Heiti TC', 'sans-serif']
plt.rcParams['axes.unicode_minus'] = False

# --- 2. 信号处理逻辑 ---

# 参数设置
fs = 1000  # 采样频率
T = 1 / fs
# 设定一个数字截止频率 (例如 0.4*pi)
omega_c_digital = 0.4 * np.pi 
f_c_physical = omega_c_digital * fs / (2 * np.pi) # 对应的物理频率 Hz

# --- 演示 1: 频率畸变曲线 ---
omega_digital = np.linspace(0, np.pi, 400) # 数字频率 0 到 pi
# 双线性变换的映射关系
Omega_analog = (2/T) * np.tan(omega_digital / 2)

# --- 演示 2: 滤波器设计实例 ---
# 步骤1: 预畸变 (Pre-warping)
Omega_c_prewarped = (2/T) * np.tan(omega_c_digital / 2)

# 步骤2: 设计模拟滤波器 H(s) (2阶巴特沃斯)
# 得到模拟系数 b_s, a_s
b_s, a_s = signal.butter(2, Omega_c_prewarped, btype='low', analog=True)

# 步骤3: 双线性变换 H(s) -> H(z)
# scipy.signal.bilinear 自动完成 s = (2/T)*(1-z^-1)/(1+z^-1) 的代换
b_z, a_z = signal.bilinear(b_s, a_s, fs=fs)

# 计算数字滤波器的频率响应
w, h = signal.freqz(b_z, a_z, worN=512)

# --- 3. 绘图与保存 ---
filename = "双线性变换法_频率畸变与响应.png"
vault_path = "/Users/heyuhang/Documents/Obsidian Vault/DSP/第四章 IIR"
full_path = os.path.join(vault_path, filename)

try:
    fig, ax = plt.subplots(1, 2, figsize=(12, 5))

    # 子图1：频率畸变关系
    ax[0].plot(omega_digital / np.pi, Omega_analog, 'b-', linewidth=2)
    ax[0].set_title('频率畸变特性 (Frequency Warping)')
    ax[0].set_xlabel(r'数字频率 $\omega$ ($\times \pi$)')
    ax[0].set_ylabel(r'模拟频率 $\Omega$ (rad/s)')
    ax[0].grid(True, linestyle=':', alpha=0.6)
    # 标注非线性
    ax[0].text(0.1, Omega_analog.max()*0.8, "低频近似线性\n高频严重压缩", fontsize=12, color='red')

    # 子图2：设计出的数字滤波器响应
    ax[1].plot(w / np.pi, 20 * np.log10(abs(h)), 'r-', linewidth=2)
    ax[1].set_title(f'双线性变换设计的低通滤波器\n(截止频率 $\omega_c = 0.4\pi$)')
    ax[1].set_xlabel(r'归一化频率 ($\times \pi$)')
    ax[1].set_ylabel('幅度 (dB)')
    ax[1].axvline(0.4, color='green', linestyle='--', label=r'目标截止 $\omega_c$')
    ax[1].set_ylim([-60, 5])
    ax[1].legend()
    ax[1].grid(True)

    if os.path.exists(full_path):
        os.remove(full_path)
    plt.savefig(full_path, dpi=300, bbox_inches='tight')
    plt.close()
    print(f"![[{filename}]]")

except Exception as e:
    print(f"Error: {e}")
```