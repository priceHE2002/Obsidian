```python
import numpy as np
import matplotlib.pyplot as plt
import os

# --- 1. Mac 环境字体配置 (陈教授专用配置) ---
plt.rcParams['font.sans-serif'] = ['Arial Unicode MS', 'Heiti TC', 'sans-serif']
plt.rcParams['axes.unicode_minus'] = False

# --- 2. 信号处理逻辑 ---

# 信号参数
f1 = 100
f2 = 105
delta_f = f2 - f1  # 频率间隔 5Hz
fs = 1000          # 采样频率 (足够高，避免混叠)

# 定义绘图函数
def analyze_duration(duration, ax, color):
    # 根据时长生成信号
    N = int(duration * fs)
    t = np.arange(N) / fs
    x = np.cos(2 * np.pi * f1 * t) + np.cos(2 * np.pi * f2 * t)
    
    # 理论分辨率
    res = 1 / duration
    
    # 计算高密度 FFT (补零以观察频谱形状)
    fft_size = 4096
    X = np.fft.fft(x, fft_size)
    freqs = np.fft.fftfreq(fft_size, 1/fs)
    
    # 移位并归一化
    X_shift = np.fft.fftshift(X)
    freqs_shift = np.fft.fftshift(freqs)
    mag = np.abs(X_shift)
    mag = mag / np.max(mag)
    
    # 绘图
    ax.plot(freqs_shift, mag, color=color, linewidth=2)
    ax.set_title(f'观测时长 $T_p={duration}$s (分辨率 $\Delta f_c = {res}$Hz)', fontsize=12)
    ax.set_xlim(80, 125)
    ax.set_ylim(0, 1.1)
    ax.grid(True, alpha=0.3)
    
    # 标记真实频率
    ax.axvline(f1, color='k', linestyle='--', alpha=0.3)
    ax.axvline(f2, color='k', linestyle='--', alpha=0.3)
    
    # 结论标注
    if res > delta_f:
        ax.text(102.5, 0.5, "分不开！\n(时长太短)", ha='center', color='red', fontweight='bold')
    else:
        ax.text(102.5, 0.5, "成功分辨！\n(双峰出现)", ha='center', color='green', fontweight='bold')

# 创建画布
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))

# 情况 1: 时长 0.1秒 (分辨率 10Hz > 5Hz，理论上分不开)
analyze_duration(0.1, ax1, 'red')

# 情况 2: 时长 0.2秒 (分辨率 5Hz = 5Hz，理论极限，可以分开)
analyze_duration(0.2, ax2, 'green')

plt.tight_layout()

# --- 3. 自动保存与显示 (固定配置) ---
filename = "矩形窗频率分辨率与时长关系.png"
vault_path = "/Users/heyuhang/Documents/Obsidian Vault"
full_path = os.path.join(vault_path, filename)

try:
    if os.path.exists(full_path):
        os.remove(full_path) # 覆盖旧图
    plt.savefig(full_path, dpi=300, bbox_inches='tight')
    plt.close() # 释放内存
    print(f"![[{filename}]]") # 触发 Obsidian 显示
except Exception as e:
    print(f"Error: {e}")
```