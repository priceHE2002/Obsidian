```python
import numpy as np
import matplotlib.pyplot as plt
import os

# --- 1. Mac 环境字体配置 (陈教授专用配置) ---
plt.rcParams['font.sans-serif'] = ['Arial Unicode MS', 'Heiti TC', 'sans-serif']
plt.rcParams['axes.unicode_minus'] = False

# --- 2. 信号处理逻辑 ---
N = 64  # 窗长

# 生成窗函数
n = np.arange(N)
# 矩形窗
w_rect = np.ones(N)
# 汉宁窗 (Hanning)
w_hanning = 0.5 - 0.5 * np.cos(2 * np.pi * n / (N - 1))
# 汉明窗 (Hamming) - 公式参考教材 (2-83)
w_hamming = 0.54 - 0.46 * np.cos(2 * np.pi * n / (N - 1))

# 计算频谱 (为了平滑显示，做高密度补零 FFT)
fft_size = 2048
W_rect = np.fft.fft(w_rect, fft_size)
W_hanning = np.fft.fft(w_hanning, fft_size)
W_hamming = np.fft.fft(w_hamming, fft_size)

# 归一化幅度谱 (dB)
def calc_db(W):
    W_mag = np.abs(W)
    W_mag = W_mag / np.max(W_mag) # 归一化到 0dB
    with np.errstate(divide='ignore'):
        W_db = 20 * np.log10(W_mag)
    return W_db

W_rect_db = calc_db(W_rect)
W_hanning_db = calc_db(W_hanning)
W_hamming_db = calc_db(W_hamming)

# 频率轴 (归一化频率 -0.5 ~ 0.5)
freqs = np.fft.fftfreq(fft_size)
freqs = np.fft.fftshift(freqs)
W_rect_db = np.fft.fftshift(W_rect_db)
W_hanning_db = np.fft.fftshift(W_hanning_db)
W_hamming_db = np.fft.fftshift(W_hamming_db)

# --- 3. 绘图 ---
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))

# 子图1：时域波形对比
ax1.plot(n, w_rect, 'k--', label='矩形窗', alpha=0.3)
ax1.plot(n, w_hanning, 'g', label='汉宁窗 (Hanning)', linewidth=2)
ax1.plot(n, w_hamming, 'r', label='汉明窗 (Hamming)', linewidth=2)
ax1.set_title('时域波形对比')
ax1.set_xlabel('样点 n')
ax1.set_ylabel('幅度')
ax1.legend()
ax1.grid(True, alpha=0.3)
# 标注 Hamming 的基座
ax1.annotate('Hamming 基座 ≈ 0.08', xy=(0, 0.08), xytext=(10, 0.2),
             arrowprops=dict(facecolor='black', arrowstyle='->'))

# 子图2：频域幅度谱 (dB) 对比
ax2.plot(freqs, W_rect_db, 'k--', label='矩形窗', alpha=0.3)
ax2.plot(freqs, W_hanning_db, 'g', label='汉宁窗')
ax2.plot(freqs, W_hamming_db, 'r', label='汉明窗')
ax2.set_title('幅度谱对比 (dB)')
ax2.set_xlabel('归一化频率 (cycles/sample)')
ax2.set_ylabel('幅度 (dB)')
ax2.set_xlim(0, 0.5) # 只看正频率
ax2.set_ylim(-100, 0)
ax2.legend()
ax2.grid(True, alpha=0.3)

# 标注第一旁瓣差异
ax2.text(0.15, -31, 'Hanning 第一旁瓣 ≈ -31dB', color='green', fontsize=9)
ax2.text(0.15, -43, 'Hamming 第一旁瓣 ≈ -43dB', color='red', fontsize=9)

plt.tight_layout()

# --- 4. 自动保存与显示 (固定配置) ---
filename = "汉明窗与汉宁窗对比.png"
vault_path = "/Users/heyuhang/Documents/Obsidian Vault"
full_path = os.path.join(vault_path, filename)

try:
    if os.path.exists(full_path):
        os.remove(full_path) # 覆盖旧图
    plt.savefig(full_path, dpi=300, bbox_inches='tight')
    plt.close() # 释放内存
    print(f"![[{filename}]]") # 触发 Obsidian 显示
except Exception as e:
    print(f"Error: {e}")
```